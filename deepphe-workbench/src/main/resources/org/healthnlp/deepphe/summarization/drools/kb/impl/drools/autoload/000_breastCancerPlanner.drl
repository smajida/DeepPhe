package org.healthnlp.deepphe.summarization.drools.rules;

//list any import classes here.
import org.healthnlp.deepphe.summarization.drools.kb.*;
import org.healthnlp.deepphe.summarization.drools.kb.impl.*;

//declare any global variables here

rule "000_breastCancerPlanner Activate when BreastNeoplasm"
    salience 1000
    when
        $g : KbGoal (name == "establish-plan",
                isActive > 0)
        BreastNeoplasm ( $id : id,  $isActive : isActive )    
    then
        System.out.println("<DROOLS-ENGINE> Stacking goals for BreastNeoplasm Analysis based on " + $id +
         "\nwith activity = " + $isActive);
         retract($g);
       
         int priority = 0;
         KbGoal newGoal = new KbGoal();
         newGoal.setName("extract-primary-tumor");
         newGoal.setIsActive(1);
         newGoal.setPriority(priority);
         insert(newGoal);
         
         priority = priority + 1;
         newGoal = new KbGoal();
         newGoal.setName("extract-tumor-size");
         newGoal.setIsActive(0);
         newGoal.setPriority(priority);
         insert(newGoal);
         
         priority = priority + 1;
         newGoal = new KbGoal();
         newGoal.setName("extract-tnm");
         newGoal.setIsActive(0);
         newGoal.setPriority(priority);
         insert(newGoal);
         
         priority = priority + 1;
         newGoal = new KbGoal();
         newGoal.setName("extract-stage");
         newGoal.setIsActive(0);
         newGoal.setPriority(priority);
         insert(newGoal);
         
         priority = priority + 1;
         newGoal = new KbGoal();
         newGoal.setName("extract-receptor-status");
         newGoal.setIsActive(0);
         newGoal.setPriority(priority);
         insert(newGoal);
        
end

rule "000_breastCancerPlanner Module Needs Written"
    salience 15
    when
        $g : KbGoal ($name : name,
                isActive == 1)
    then
        System.out.println("<DROOLS-ENGINE> module for " + $name + " needs written.");
        retract($g);
    end
    
rule "000_breastCancerPlanner Activate Next Goal"
	salience 10
	when
		$g : KbGoal ($nameOne : name, 
		             $priorityOne : priority, 
		             isActive == 0)
		not  KbGoal ($nameTwo : name, 
		             priority < $priorityOne, 
		             isActive == 0)
	then
	    System.out.println("<DROOLS-ENGINE> The new goal " + $nameOne + " is activated.");
		modify($g) { setIsActive(1); }
	end
